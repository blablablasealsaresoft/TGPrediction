# ============================================================================
# üî• API ENHANCEMENTS - Added 2025-01-11
# ============================================================================
# Copy these lines and ADD to the END of your existing .env file
# These are FREE APIs that don't need new keys!
# ============================================================================

# ============================================================================
# üåü ENHANCED PRICE FEEDS (Multi-Source Redundancy)
# ============================================================================

# Pyth Network - Real-time Oracle (FREE, No Key Needed!)
PYTH_PRICE_FEED_ENABLED=true
PYTH_API_URL=https://hermes.pyth.network/api
PYTH_SOL_USD_FEED_ID=ef0d8b6fda2ceba41da15d4095d1da392a0d2f8ed0c6c7bc0f4cfac8c280b56d
PYTH_USDC_USD_FEED_ID=eaa020c61cc479712813461ce153894a96a6c00b21ed0cfc2798d1f9a9e9c94a
PYTH_BTC_USD_FEED_ID=e62df6c8b4a85fe1a67db44dc12de5db330f7ac66b72dc658afedf0f4a415b43
PYTH_ETH_USD_FEED_ID=ff61491a931112ddf1bd8147cd1b641375f79f5825126d665480874634fd0ace
PYTH_TIMEOUT=5
PYTH_FALLBACK=true

# Jupiter Price API V4 (Already using via quote API, now explicit)
JUPITER_PRICE_API_V4_ENABLED=true
JUPITER_PRICE_API_V4_URL=https://price.jup.ag/v4
JUPITER_PRICE_FALLBACK=true

# ============================================================================
# üõ°Ô∏è ENHANCED SECURITY (7th & 8th Honeypot Methods)
# ============================================================================

# TokenSniffer (FREE Honeypot Detection - No Key Needed!)
TOKEN_SNIFFER_API_URL=https://tokensniffer.com/api/v2/tokens/solana
TOKEN_SNIFFER_ENABLED=true
TOKEN_SNIFFER_FALLBACK=true
TOKEN_SNIFFER_TIMEOUT=10
TOKEN_SNIFFER_MIN_SCORE=60

# RugDoc API (FREE Professional Audits - No Key Needed!)
RUGDOC_API_URL=https://api.rugdoc.io/v1
RUGDOC_ENABLED=true
RUGDOC_FALLBACK=true
RUGDOC_TIMEOUT=10

# Solana Beach (FREE Network Stats - No Key Needed!)
SOLANA_BEACH_API_URL=https://api.solanabeach.io/v1
SOLANA_BEACH_ENABLED=true
SOLANA_BEACH_TIMEOUT=10

# ============================================================================
# üí± ENHANCED DEX APIs (Direct Pool Data)
# ============================================================================

# NOTE: You already have Raydium, Orca, Meteora URLs defined above
# These add explicit enable flags and endpoints for clarity

# Raydium - Explicit pool endpoints
RAYDIUM_ENABLED=true
RAYDIUM_POOLS_LIST_ENDPOINT=/pools/info/list
RAYDIUM_POOL_INFO_BY_ID_ENDPOINT=/pools/info/ids
RAYDIUM_FALLBACK=true

# Orca - Explicit Whirlpool endpoints  
ORCA_ENABLED=true
ORCA_WHIRLPOOL_LIST_ENDPOINT=/v1/whirlpool/list
ORCA_POOL_INFO_ENDPOINT=/v1/whirlpool/
ORCA_FALLBACK=true

# Meteora - Explicit DLMM endpoints
METEORA_ENABLED=true
METEORA_PAIR_LIST_ENDPOINT=/pair/all
METEORA_PAIR_INFO_ENDPOINT=/pair/
METEORA_FALLBACK=true

# ============================================================================
# üéØ ENHANCED LAUNCH DETECTION
# ============================================================================

# Pump.fun - Already monitoring, now explicit config
PUMPFUN_API_ENABLED=true
PUMPFUN_API_URL=https://frontend-api.pump.fun
PUMPFUN_NEW_TOKENS_ENDPOINT=/coins/latest
PUMPFUN_TOKEN_INFO_ENDPOINT=/coins/
PUMPFUN_FALLBACK=true

# Birdeye - Already configured, adding endpoints
BIRDEYE_NEW_LISTING_ENDPOINT=/defi/v3/tokens/new_listing
BIRDEYE_TOKEN_SECURITY_ENDPOINT=/defi/token_security
BIRDEYE_FALLBACK=true

# DexScreener - Already configured, adding endpoints
DEXSCREENER_LATEST_ENDPOINT=/dex/tokens/
DEXSCREENER_PAIRS_ENDPOINT=/dex/pairs/solana/
DEXSCREENER_FALLBACK=true

# ============================================================================
# üîÑ INTELLIGENT API FALLBACK STRATEGIES
# ============================================================================

# Price Data Fallback (tries in order until success)
PRICE_API_FALLBACK_ORDER=jupiter,pyth,birdeye,coingecko,raydium,orca
PRICE_API_MAX_RETRIES=3
PRICE_API_RETRY_DELAY_SECONDS=1
PRICE_API_REQUIRE_CONSENSUS=false
PRICE_API_CONSENSUS_SOURCES=2

# Token Data Fallback
TOKEN_DATA_FALLBACK_ORDER=birdeye,dexscreener,raydium,orca,meteora,pumpfun
TOKEN_DATA_MAX_RETRIES=2
TOKEN_DATA_RETRY_DELAY_SECONDS=1

# Security Check Fallback (multi-source validation)
SECURITY_CHECK_FALLBACK_ORDER=rugcheck,goplus,tokensniffer,rugdoc
SECURITY_CHECK_MIN_SOURCES=2  # Require at least 2 sources to agree
SECURITY_CHECK_MAX_RETRIES=2
SECURITY_CHECK_CONSENSUS_REQUIRED=true

# Transaction Parsing Fallback
TX_PARSING_FALLBACK_ORDER=helius,solanafm,solanabeach,standard_rpc
TX_PARSING_MAX_RETRIES=2
TX_PARSING_RETRY_DELAY_SECONDS=1

# Launch Detection Fallback (multi-source confirmation)
LAUNCH_DETECTION_FALLBACK_ORDER=birdeye,dexscreener,pumpfun,solanatracker
LAUNCH_DETECTION_MIN_SOURCES=2  # Require 2 sources to confirm new launch
LAUNCH_DETECTION_MAX_AGE_MINUTES=120  # Only launches <2 hours old

# ============================================================================
# üìä API HEALTH & PERFORMANCE MONITORING
# ============================================================================

# Track API performance for intelligent routing
TRACK_API_LATENCY=true
TRACK_API_SUCCESS_RATE=true
TRACK_API_FAILURES=true
TRACK_API_AVAILABILITY=true
API_HEALTH_CHECK_INTERVAL=300  # Check every 5 minutes

# Auto-failover settings
AUTO_FAILOVER_ENABLED=true
AUTO_FAILOVER_ERROR_THRESHOLD=3  # Failover after 3 consecutive errors
AUTO_FAILOVER_TIMEOUT_THRESHOLD=2  # Failover if API times out 2+ times
AUTO_FAILOVER_COOLDOWN_MINUTES=15  # Wait 15min before retry
AUTO_FAILOVER_NOTIFY_ADMIN=true

# Performance-based routing (use fastest API automatically)
ENABLE_SMART_ROUTING=true
SMART_ROUTING_USE_FASTEST=true
SMART_ROUTING_CACHE_TTL=300  # Cache performance data for 5 minutes

# ============================================================================
# üéØ ENHANCED ARBITRAGE DETECTION
# ============================================================================

# Cross-DEX price comparison (now with 6 DEXs instead of 3)
ARBITRAGE_COMPARE_DEXES=jupiter,raydium,orca,meteora,phoenix
ARBITRAGE_MIN_PRICE_DIFFERENCE_BPS=50  # 0.5% minimum
ARBITRAGE_INCLUDE_GAS_COSTS=true
ARBITRAGE_MAX_EXECUTION_TIME_MS=500

# Multi-hop arbitrage
ARBITRAGE_ENABLE_MULTI_HOP=true
ARBITRAGE_MAX_HOPS=3
ARBITRAGE_FIND_TRIANGULAR=true  # SOL -> TOKEN -> USDC -> SOL

# ============================================================================
# üî• ENHANCED VALIDATION & CROSS-REFERENCING
# ============================================================================

# Cross-reference token data across multiple sources
ENABLE_CROSS_REFERENCE_VALIDATION=true
CROSS_REFERENCE_PRICE_TOLERANCE_PCT=5.0  # Alert if prices differ >5%
CROSS_REFERENCE_LIQUIDITY_TOLERANCE_PCT=10.0

# Consensus-based safety (multiple sources must agree)
ENABLE_CONSENSUS_SAFETY=true
CONSENSUS_MIN_SOURCES=2
CONSENSUS_AGREEMENT_THRESHOLD=0.75  # 75% of sources must agree

# ============================================================================
# üöÄ ADDITIONAL FREE APIS TO SIGN UP FOR (OPTIONAL)
# ============================================================================

# SolanaTracker (Sign up at solanatracker.io)
SOLANA_TRACKER_API_KEY=  # Free tier: 1000 req/day
SOLANA_TRACKER_API_URL=https://data.solanatracker.io
SOLANA_TRACKER_ENABLED=false  # Enable when you get key
SOLANA_TRACKER_TIMEOUT=10

# Solana FM (Sign up at solana.fm)
SOLANA_FM_API_KEY=  # Free tier: 100 req/day
SOLANA_FM_API_URL=https://api.solana.fm
SOLANA_FM_ENABLED=false  # Enable when you get key
SOLANA_FM_TIMEOUT=10

# Whale Alert (Sign up at whale-alert.io)
WHALE_ALERT_API_KEY=  # Free tier: 1000 req/month
WHALE_ALERT_API_URL=https://api.whale-alert.io
WHALE_ALERT_ENABLED=false  # Enable when you get key
WHALE_ALERT_MIN_VALUE_USD=100000

# Defined.fi (Sign up at defined.fi)
DEFINED_API_KEY=  # Free tier available
DEFINED_API_URL=https://api.defined.fi
DEFINED_ENABLED=false  # Enable when you get key

# Step Finance (Sign up at step.finance)
STEP_FINANCE_API_URL=https://api.step.finance
STEP_FINANCE_ENABLED=false  # Enable when you get key

# ============================================================================
# üìù ENHANCEMENT SUMMARY
# ============================================================================

# WHAT WAS ADDED:
# ‚úÖ Pyth Network (real-time price oracle)
# ‚úÖ TokenSniffer (7th honeypot method)
# ‚úÖ RugDoc (professional audits)
# ‚úÖ Solana Beach (network stats)
# ‚úÖ Explicit Raydium/Orca/Meteora endpoints
# ‚úÖ Pump.fun explicit configuration
# ‚úÖ Intelligent fallback strategies for all data types
# ‚úÖ API health monitoring and auto-failover
# ‚úÖ Consensus-based validation
# ‚úÖ Performance-based smart routing

# BENEFITS:
# üéØ 2-3x API redundancy on critical data
# üéØ Automatic failover if APIs go down
# üéØ Cross-validation of prices and security
# üéØ Faster with smart routing (uses fastest API)
# üéØ More accurate with consensus validation
# üéØ 7 honeypot methods (vs 6 before)
# üéØ 6 price sources (vs 3 before)
# üéØ 4 security sources (vs 2 before)

# COST: $0 (all free APIs, no new keys needed)

# TO ACTIVATE:
# 1. Add these lines to the END of your .env file
# 2. Restart bot: docker-compose -f docker-compose.prod.yml restart trading-bot
# 3. Check logs for new API references

# ================================
# END OF ENHANCEMENTS
# ================================

